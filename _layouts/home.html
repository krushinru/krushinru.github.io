---
layout: default
---

<main class="main-block">
  <div class="row">
    <div class="col-12">
      <h1>{{ site.author.name | default: site.title }}</h1>
      <p class="lead">
        {{ site.author.bio | default: site.description }}
      </p>
      {% if site.author.links %}
      <nav class="main-links">
        {% for link in site.author.links %}
        <a href="{{ link.url }}">{{ link.title }}</a>
        {% endfor %}
      </nav>
      {% endif %}
      <div class="main-contact">
        Связаться: <a href="mailto:{{ site.email }}">{{ site.email }}</a>
      </div>
    </div>
  </div>
</main>

{{ content }}

{% if site.projects.size > 0 %}
<section class="section" style="margin-top: 0px;" id="projects">
  <div class="projects-editorial-grid">
    {% assign projects = site.projects | sort: 'launch_year' | reverse %}
    {% assign column_counter = 0 %}
    
    {% for project in projects limit: 2 %}
      {% assign has_screenshot = false %}
      {% if project.screenshot and project.screenshot != "" %}
        {% assign has_screenshot = true %}
      {% endif %}
      
      {% assign has_icon = false %}
      {% if project.icon and project.icon != "" %}
        {% assign has_icon = true %}
      {% endif %}
      
      {% assign has_stats = false %}
      {% if project.stats and project.stats.size > 0 %}
        {% assign has_stats = true %}
      {% endif %}
      
      {% assign has_media = false %}
      {% if project.media and project.media.size > 0 %}
        {% assign has_media = true %}
      {% endif %}
      
      {% assign long_subtitle = false %}
      {% if project.subtitle and project.subtitle.size > 150 %}
        {% assign long_subtitle = true %}
      {% endif %}
      
      {% comment %} Определяем тип карточки {% endcomment %}
      {% assign card_type = "compact" %}
      {% assign card_span = 1 %}
      
      {% if has_screenshot and long_subtitle %}
        {% assign card_type = "hero" %}
        {% assign card_span = 3 %}
        {% assign column_counter = 0 %}
      {% elsif has_stats or has_media %}
        {% assign card_type = "feature" %}
        {% comment %} Если осталась 1 колонка - делаем compact {% endcomment %}
        {% if column_counter == 2 %}
          {% assign card_type = "compact" %}
          {% assign card_span = 1 %}
          {% assign column_counter = 0 %}
        {% else %}
          {% assign card_span = 2 %}
          {% assign column_counter = column_counter | plus: 2 %}
          {% if column_counter >= 3 %}
            {% assign column_counter = 0 %}
          {% endif %}
        {% endif %}
      {% else %}
        {% assign card_span = 1 %}
        {% assign column_counter = column_counter | plus: 1 %}
        {% if column_counter >= 3 %}
          {% assign column_counter = 0 %}
        {% endif %}
      {% endif %}
      
      <article class="project-editorial-card project-{{ card_type }}" 
               style="grid-column: span {{ card_span }};"
               data-status="{% if project.close_year and project.close_year != '' %}closed{% else %}active{% endif %}"
               data-roles="{{ project.roles | join: ',' | downcase }}">
        <a href="{{ project.url | relative_url }}" class="project-editorial-link">
          
          {% if card_type == "hero" %}
            <!-- Hero Layout -->
            <div class="project-hero-header">
              <h3 class="project-hero-title">{{ project.title }}</h3>
              <span class="project-hero-years">
                {% if project.launch_year %}
                  {{ project.launch_year }}
                  {% if project.close_year and project.close_year != project.launch_year %}
                  &nbsp;–&nbsp;{{ project.close_year }}
                  {% elsif project.close_year == nil or project.close_year == "" %}
                  &nbsp;–&nbsp;∞
                  {% endif %}
                {% endif %}
              </span>
            </div>
            
            {% if has_screenshot %}
            <div class="project-hero-image">
              <img src="{{ project.screenshot | relative_url }}" alt="{{ project.title }}" loading="lazy">
            </div>
            {% endif %}
            
            {% if project.subtitle %}
            <div class="project-hero-subtitle">
              {{ project.subtitle }}
            </div>
            {% endif %}
            
          {% elsif card_type == "feature" %}
            <!-- Feature Layout -->
            <div class="project-feature-inner">
              {% if has_icon %}
              <div class="project-feature-icon">
                <img src="{{ project.icon | relative_url }}" alt="{{ project.title }}" loading="lazy">
              </div>
              {% elsif has_screenshot %}
              <div class="project-feature-screenshot">
                <img src="{{ project.screenshot | relative_url }}" alt="{{ project.title }}" loading="lazy">
              </div>
              {% endif %}
              
              <div class="project-feature-content">
                <div class="project-feature-header">
                  <h3 class="project-feature-title">{{ project.title }}</h3>
                  <span class="project-feature-years">
                    {% if project.launch_year %}
                      {{ project.launch_year }}
                      {% if project.close_year and project.close_year != project.launch_year %}
                        &nbsp;–&nbsp;{{ project.close_year }}
                      {% elsif project.close_year == nil or project.close_year == "" %}
                        &nbsp;–&nbsp;∞
                      {% endif %}
                    {% endif %}
                  </span>
                </div>
                
                {% if project.subtitle %}
                <p class="project-feature-desc">{{ project.subtitle | truncate: 140 }}</p>
                {% endif %}
                
                {% if has_media %}
                <div class="project-feature-media">
                  <span class="project-feature-media-link">
                    <img src="https://www.google.com/s2/favicons?domain={{ project.media[0].url }}&sz=32" 
                         alt="{{ project.media[0].source }}" 
                         class="project-feature-media-favicon"
                         loading="lazy">
                    <span class="project-feature-media-text">{{ project.media[0].title }}</span>
                  </span>
                </div>
                {% endif %}
              </div>
            </div>
            
          {% else %}
            <!-- Compact Layout -->
            <div class="project-compact-content">
              <div class="project-compact-header">
                <h3 class="project-compact-title">{{ project.title }}</h3>
                <span class="project-compact-years">
                  {% if project.launch_year %}
                    {{ project.launch_year }}
                    {% if project.close_year and project.close_year != project.launch_year %}
                      &nbsp;–&nbsp;{{ project.close_year }}
                    {% elsif project.close_year == nil or project.close_year == "" %}
                      &nbsp;–&nbsp;∞
                    {% endif %}
                  {% endif %}
                </span>
              </div>
              
              {% if project.subtitle %}
              <p class="project-compact-desc">{{ project.subtitle | truncate: 120 }}</p>
              {% endif %}
              
              {% if has_stats %}
              <div class="project-compact-stat">
                <div class="compact-stat-value">{{ project.stats[0].value }}</div>
                <div class="compact-stat-label">{{ project.stats[0].label }}</div>
              </div>
              {% endif %}
            </div>
          {% endif %}
          
        </a>
      </article>
    {% endfor %}
  </div>
  {% if site.projects.size > 2 %}
  <a href="/projects/" class="view-more">Смотреть все проекты →</a>
  {% endif %}
</section>
{% endif %}

{% if site.posts.size > 0 %}
<section class="section" id="blog">
  <h4 class="section-title">Веду заметки</h2>
  {% for post in site.posts limit: 5 %}
  <div class="post-item">
    <h3 class="post-title"><a href="{{ post.url | relative_url }}">{{ post.title }}</a></h3>
    {% if post.lead %}
    <div class="post-lead">{{ post.lead | markdownify }}</div>
    {% endif %}
    
    <div class="post-tags">
      {% assign now_sec = site.time | date: '%s' %}
      {% assign post_sec = post.date | date: '%s' %}
      {% assign diff_sec = now_sec | minus: post_sec %}
      {% assign diff_days = diff_sec | divided_by: 86400 %}
      
      {% if diff_days == 0 %}
        <time datetime="{{ post.date | date_to_xmlschema }}">сегодня</time>
      {% elsif diff_days < 30 %}
        <time datetime="{{ post.date | date_to_xmlschema }}">{{ diff_days }} дн</time>
      {% elsif diff_days < 365 %}
        {% assign diff_months = diff_days | divided_by: 30 %}
        <time datetime="{{ post.date | date_to_xmlschema }}">{{ diff_months }} мес</time>
      {% else %}
        <time datetime="{{ post.date | date_to_xmlschema }}">{{ post.date | date: '%Y' }}</time>
      {% endif %}
      
      {% for tag in post.tags %}
        <a href="{{ tag }}" class="tag">{{ tag }}</a>
      {% endfor %}
    </div>
  </div>
  {% endfor %}
  {% if site.posts.size > 5 %}
  <a href="/blog/" class="view-more">Все записи →</a>
  {% endif %}
</section>
{% endif %}
